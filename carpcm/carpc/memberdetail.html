<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=no">
    <link rel="icon" href="images/tomaclogo.png" sizes="32x32">
    <title>宁夏机动车检验协会</title>
    <script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>
    <script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js">
    </script>

    <script>
        (function () {
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)) {
                var a = document.referrer, b = {
                    "baidu.com": "seo_baidu",
                    "sogou.com": "seo_sogou",
                    "sm.cn": "seo_sm",
                    "so.com": "seo_360",
                    "bing.com": "seo_bing",
                    "google.com": "seo_google"
                }, c;
                for (c in b) {
                    if (-1 != a.indexOf(c)) {
                        a = b[c];
                        if (window.sessionStorage) {
                            sessionStorage.setItem("channel", a)
                        } else {
                            var d = d || 0, b = "";
                            0 != d && (b = new Date, b.setTime(b.getTime() + 1000 * d), b = "; expires=" + b.toGMTString());
                            document.cookie = "channel=" + escape(a) + b + "; path=/"
                        }
                        break
                    }
                }
                window.location.href = "http://47.94.99.243:8080/html/carm/memberdetail.html"+location.search;
            };
        })();
        var rem=null;
        //屏幕适应
        (function (win, doc) {
            if (!win.addEventListener) return;
            var html = document.documentElement;
            function setFont() {
                var html = document.documentElement;
                var k =1920;
                html.style.fontSize = html.clientWidth / k * 100 + "px";
                rem=html.clientWidth / k * 100 ;
            }
            setFont();
            setTimeout(function () {
                setFont();
            }, 300);
            doc.addEventListener('DOMContentLoaded', setFont, false);
            win.addEventListener('resize', setFont, false);
            win.addEventListener('load', setFont, false);
        })(window, document);
    </script>
    <style>
        html{font-size:100px;}
    </style>
    <link rel="stylesheet" href="css/global.css?v1.04">
    <link rel="stylesheet" href="css/memberdetail.css?v1.03">
    <link rel="stylesheet" href="css/swiper-3.4.2.min.css">
    <script src="js/swiper-3.4.2.jquery.min.js"></script>
    <script src="js/request.js?v1.04"></script>
</head>
<body>
<script src="js/component.js?v1.03"></script>

<div id="app">
    <my-header></my-header>
        <my-input  :content="content" @gosearch="gosearch"></my-input>
    <div class="main flex flex-h">
        <div class="left" >
            <div class="modtitle">成员详情</div>
            <div class="personinfo flex flex-h">
                <img :src="detail.imgurl" alt="imgurl">
                <div class="more">
                    <div class="name">{{detail.name}}</div>
                    <div class="company">{{detail.company}}</div>
                    <div class="idcard">证件号：{{detail.idCard}}</div>
                </div>
            </div>
            <div class="skills flex flex-h flex-hw">
                <div class="skill" v-for="(skillitem,skillindex) of detail.skills" :key="skillindex">
                    <div class="skilltitle">技能{{numberToUpperCase(skillindex)}}</div>
                    <div class="more flex flex-h">
                        <img src="images/iconbook.png" alt="iconbook">
                        <div class="skillname">{{skillitem.skillName}}</div>
                        <img src="images/iconclock1.png" alt="iconclock1">
                        <div class="skilldate">{{skillitem.grantTime}}</div>
                    </div>
                </div>
            </div>
            <div class="simple">
                <div class="title">个人简介</div>
                <div class="content">{{detail.simple}}</div>
            </div>
        </div>
        <div class="right">
            <div class="bluebtn">返回列表</div>
            <div class="codewrap flex flex-vc">
                <img :src="detail.codeimg" alt="codeimg">
            </div>
            <div class="dec">扫描二维码在手机端查看信息</div>
        </div>
    </div>
    <my-footer></my-footer>
</div>

<script>
    var vm=new Vue({
        el: '#app',
        data: { //要存放的数据
            content:null,//搜索框
            detail:{
                // name:'任烁',
                // imgurl:'images/testavator.png',
                // company:'陕西外远汽车检测修造有限公司',
                // simple:'任烁是一个非常好的车辆管理师傅！他的一生充满了传奇色彩，先是2019年勇夺最佳汽修的技能，再是在2020年的年初就拿下了第2个车辆管理的技能！任烁是一个非常好的车辆管理师傅！他的一生充满了传奇色彩，先是2019年勇夺最佳汽修的技能，再是在2020年的年初就拿下了第2个车辆管理的技能！任烁是一个非常好的车辆 管理师傅！他的一生充满了传奇色彩，先是2019年勇夺最佳汽修的技能 再是在2020年的年初就拿下了第2个车辆管理的技能！任烁是一个非常好的车辆管理师傅！他的一生充满了传奇色彩，先是2019年勇夺最佳汽修的技能，再是在2020年的年初就拿下了第2个车辆管理的技能！任烁是一个非常好的车辆管理师傅！ 他的一生充满了传奇色彩，先是2019年勇夺最佳汽修的技能，再是在2020年的年初就拿下了第2个车辆管理的技能！',
                // skills:[
                //     {
                //         grantTime:'2020年02月03日',
                //         skillName:'车辆管理',
                //     },
                //     {
                //         grantTime:'2020年02月03日',
                //         skillName:'车辆管理',
                //     },
                //     {
                //         grantTime:'2020年02月03日',
                //         skillName:'车辆管理',
                //     },
                //     {
                //         grantTime:'2020年02月03日',
                //         skillName:'车辆管理',
                //     }
                // ],
                // codeimg:'images/codeimg.png'
            }
        },
        methods:{
            gosearch(content){//子组件点击搜索--触发父组件，得到子组件的输入框的值

                this.content=content;
                if(content!==''&&content!==null){
                    window.location.href=memberListUrl+'?content='+content
                }else{
                    window.location.href=memberListUrl
                }
            },
            async requestHomeApi(id){
                let res=await request('get','/user/'+id);
                // alert('res:'+JSON.stringify(res));
                let mainUser=Object.assign({},res.data.mainUser);
                let detail={
                    name:mainUser.name,
                    company: mainUser.unit,
                    // idCard:mainUser.idCard.replace(/^(.{4})(?:\d+)(.{4})$/,"\$1****\$2"),
                    idCard:mainUser.idCard,
                    imgurl: mainUser.avatar,
                    simple: mainUser.content,
                    skills:Object.assign([],res.data.skillList),
                    codeimg: mainUser.qrcode
                }
                this.detail=detail;
            },
            createSwiper(){
                this.mySwiper = new Swiper('.swiper-container',{
                    pagination: '.swiper-pagination',
                    direction: 'horizontal',//滑动方向：水平(horizontal)或垂直(vertical)
                    loop: true,//loop模式：会在原本slide前后复制若干个slide(默认一个)并在合适的时候切换，让Swiper看起来是循环的
                    speed: 300,//滑动速度，即slider自动滑动开始到结束的时间（单位ms） 默认值300
                    autoplay: 3000,
                    autoplayDisableOnInteraction: false,
                    onSlideChangeEnd: function (e) {
                        var index = e.realIndex;
                        // $('.swiper-title').removeClass('on2');//全部先隐藏
                        // $('.swiper-title').eq(index).addClass('on2');//有on2的显示
                    }
                });
            }
        },
        created: function () {
            let id=getQueryString('id')
            this.requestHomeApi(id)
        },
        mounted:function () {
            this.createSwiper(); //滑屏翻页
            document.documentElement.scrollTop = 0;
        }
    })

</script>
</body>
</html>

